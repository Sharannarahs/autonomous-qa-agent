<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>E-Shop Checkout</title>
  <style>
    .error { color: red; }
    .success { color: green; }
    #pay-now { background: green; color: white; padding: 10px; }
  </style>
</head>
<body>

<h1>E-Shop Checkout</h1>

<div id="products">
  <div>
    <h3>Item A</h3>
    <p>Price: $20</p>
    <button id="add-item1" class="add-to-cart">Add to Cart</button>
  </div>

  <div>
    <h3>Item B</h3>
    <p>Price: $30</p>
    <button id="add-item2" class="add-to-cart">Add to Cart</button>
  </div>

  <div>
    <h3>Item C</h3>
    <p>Price: $10</p>
    <button id="add-item3" class="add-to-cart">Add to Cart</button>
  </div>
</div>

<h2>Cart Summary</h2>
<div id="cart-summary">
  <div id="cart-items"></div>

  <label>Discount Code:
    <input id="discount-code" type="text">
  </label>
  <button id="apply-discount">Apply</button>
  <span id="discount-msg"></span>

  <h3>Shipping</h3>
  <label><input type="radio" name="shipping" value="standard" checked> Standard (free)</label>
  <label><input type="radio" name="shipping" value="express"> Express ($10)</label>

  <h3>Total: $<span id="total">0</span></h3>
</div>

<h2>User Details</h2>
<form id="checkout-form">
  <label>Name: <input id="name" type="text" required></label><br>
  <label>Email: <input id="email" type="email" required></label>
  <div id="email-error" class="error" style="display:none;">Invalid email</div>
  <br>
  <label>Address: <input id="address" type="text" required></label><br>

  <h3>Payment</h3>
  <label><input type="radio" name="payment" value="card" checked> Credit Card</label>
  <label><input type="radio" name="payment" value="paypal"> PayPal</label>

  <br><br>
  <button id="pay-now" type="submit">Pay Now</button>
  <div id="result"></div>
</form>

<script>
const prices = { item1:20, item2:30, item3:10 };
let cart = {};

function updateTotal() {
  let total = 0;
  for (let id in cart) total += cart[id] * prices[id];

  if (document.querySelector('input[name="shipping"]:checked').value === "express")
    total += 10;

  document.getElementById("total").textContent = total.toFixed(2);
}

document.querySelectorAll(".add-to-cart").forEach(btn => {
  btn.onclick = () => {
    let id = btn.id.replace("add-","");
    cart[id] = (cart[id] || 0) + 1;

    document.getElementById("cart-items").innerHTML = "";
    for (let x in cart) {
      document.getElementById("cart-items").innerHTML += x + ": " + cart[x] + "<br>";
    }

    updateTotal();
  };
});

document.getElementById("apply-discount").onclick = () => {
  let code = document.getElementById("discount-code").value.trim();
  let msg = document.getElementById("discount-msg");

  if (code === "SAVE15") {
    msg.textContent = "Discount applied!";
    msg.className = "success";

    let total = parseFloat(document.getElementById("total").textContent);
    document.getElementById("total").textContent = (total * 0.85).toFixed(2);
  } else {
    msg.textContent = "Invalid code";
    msg.className = "error";
  }
};

document.getElementById("checkout-form").onsubmit = e => {
  e.preventDefault();

  let email = document.getElementById("email").value;
  if (!email.includes("@")) {
    document.getElementById("email-error").style.display = "block";
    return;
  }

  document.getElementById("email-error").style.display = "none";
  document.getElementById("result").textContent = "Payment Successful!";
};
</script>

</body>
</html>
